# X-ARF Specification *v0.1*

This is a short specification for X-ARF (Extended Abuse Reporting Format). 
If you are interested in joining us and/or also start reporting in X-ARF or you think that you might have some valuable ideas, feel that there's still things missing etc., let us know. We are happy to get as much feedback as possible. 

## 0. The idea of X-ARF

X-ARF is designed as a pure container format, where everyone can plug in as many specific containers as he wants to. The content of such containers can be completely different from others. The container itself will be defined in schemes. These schemes contain all information about the meaning of each listed field (mandatory, optional, data type, allowed values,...). To make it easy to read the content of a X-ARF report (just like ARF) the information is represented in [YAML](http://en.wikipedia.org/wiki/YAML). The schemes themselves are defined in JSON-schema, draft 02 (please notice!).    
To make sure everybody can understand all available schemes, this community has been established. This community discusses e.g. new containers and additional information for existing containers. Mostly all members of the community also use X-ARF for real-life reporting and abuse handling. Available schemes are versioned and published on [x-arf.org](http://www.x-arf.org/schemata.html). That way every parser is able to validate against the latest X-ARF schema and thus is able to handle it.    
Please notice that the status of this document still is a draft. If you want to start reporting in X-ARF, feel free to join the X-ARF [mailinglist](http://lists.x-arf.org/cgi-bin/mailman/listinfo/) as well.

## 1. Overview of a X-ARF Report Email

### Header

Please add some mandatory headers to your X-ARF Reports to let parsers identify incoming reports properly:

* <code>Auto-Submitted: auto-generated</code> according to RFC3834 [mandatory if autogenerated]
* <code>X-ARF: YES</code> according to RFC822 [mandatory]
* <code>X-XARF: PLAIN</code> according to RFC822 [recommended, for forward compatibility to specification v0.2]
* <code>Content-Type: multipart/mixed</code> [mandatory]
* We recommend to use an easy to understand subject line as follows:
  * <code>abuse report about *source* - *date*</code> [recommended]

### 1st MIME part

Human readable text which contains at least basic information about the reported incident.

* <code>Content-Type: text/plain</code>   
* <code>charset=utf-8</code>

### 2nd MIME part

The data is a JSON object (a list of key/value pairs) represented in [YAML](http://www.yaml.org) notation.   
Receivers must be able to validate against the provided JSON scheme ([more info](http://www.x-arf.org/tools.html)).

* Machine- and human-readable
* <code>Content-Type: text/plain</code>
* <code>charset=utf-8</code>
* <code>name="report.txt"</code>

### 3rd MIME part

* Of any MIME types (which are specified in a referenced scheme)
* Contains e.g. evidence which may be anonymized
* Of any content
* Optional or mandatory as defined in the corresponding schema


### Content of the 2nd MIME part: Mandatory and optional keys/fields

Within the 2nd MIME part, the following mandatory and optional fields are used. Furthermore, specific reports may use specific mandatory or optional fields.

##### Reported-From: [mandatory][only once]

This field contains the sending e-mail address. 

* Example: <code>Reported-From: reporter@example.com</code>
    
##### Category: [mandatory][only once]

This field must contain one of the following categories:

|Category|Explanation|
|--------|-----------|
|abuse|technical abusive behavior - any kinds of attacks like virus, malware, bot, logins, etc.|
|fraud|financial abuse like creditcard-fraud, etc.|
|auth|misuse or failure of authentification methods, SSL, SSH, POP3, etc.|
|info|all sorts of pure informational reports like blacklistings, delistings|
|private|all sorts of closed information exchange between 2 or more parties|

Usually, this field will be defined by the X-ARF-community and the reporting party. 

* Example: <code>Category: abuse</code> 


##### Report-Type: [mandatory][only once]

This field contains the type of report. For example login-attack, phishing-website, spamvertized, etc. Usually this field will be defined by X-ARF-community and the reporting party to make sure it has a unique meaning across all available schemas. 

* Example: <code>Report-Type: login-attack</code>

##### User-Agent: [mandatory][only once]

Name and version of the generating software (see RFC1945 and RFC2068) 

* Example: <code>User-Agent: xarf-reporter/1.0 (X-ARF Reporting Toolset v1.0)</code>

##### Report-ID: [mandatory][only once]

The Report-ID for a report containing (one) specific incident(s) must be unique across time and space, so that different receivers of (e.g. forwarded) reports are able to distinguish, compare and consolidate reports among themselves. Further, the Report-ID must have a reasonable domain part.   

* We recommend to use a combination of a (compact) UUID and your domain: <code>[any unique ID]@yourdomain.tld</code> 
* Example: <code>Report-ID: e9e1fd60c855012f30ab60c5470a79c4@yourdomain.tld</code> 

##### Date: [mandatory][only once]

This field contains the date of the incident itself or date when the incident has been discovered (if not reported realtime). The date should be in RFC 3339 format - if the x-arf schema specifies the date with "format":"date-time". Due to compatibility reasons the date may be written in the RFC 2822 format, no matter if "format":"date-time" is used or not in a x-arf schema description. Therefore, parser implementations should check which of the both formats is used. 

* Example (RFC 2822 format): <code>Date: Mon, 05 Aug 2012 16:19:15 -0000</code> 
* Example (RFC 3339 format): <code>Date: 2012-04-12T23:20:50.52Z</code> 

##### Source: [mandatory][only once]

Contains the source of abusive behavior. It is described by <Source-Type:>. 

* Examples: 
  * <code>Source: 192.168.1.134</code>
  * <code>Source: 2001:898:2000:c:213:206:89:190</code>
  * <code>Source: https://www.domain.tld/folder/file.xxx</code>
  * <code>Source: domain.tld</code></code>
  * <code>Source: localpart@domain.tld</code>

##### Source-Type: [mandatory][only once]

Currently the following Types are used: <code>ipv4</code> or <code>ip-address</code> (RFC 791 compliant IP-address), <code>ipv6</code> (RFC 2460 compliant IP-address), <code>uri</code> (RFC 2396 compliant URI), <code>domain</code>, <code>email</code>

* Example: <code>Source-Type: ipv4</code> 

##### Attachment: [mandatory][only once]

This field defines whether an attachment with further information exists or not. If no such attachments exists, this field has to be set to "none". If an attachment exists, this field must contain the MIME type of the following attachment. 

* Example: <code>Attachment: text/plain</code> 

##### Schema-URL: [mandatory][only once]

This field contains the URI to the JSON-schema that describes the content of the report. The schema must be published under and the URI must point to the www.x-arf.org domain. If <Category:> is set to private the schema may be published according to what the involved parties agreed upon. 

* Example: <code>Schema-URL: http://www.x-arf.org/schema/abuse_login-attack_0.1.2.json</code>

##### Version: [optional][only once]

This field contains the version of this specification.  
*The current version number is 0.1*

* Example: <code>Version: 0.1</code> 

##### Occurrences: [optional][only once]

Though each incident should be reported on its own, this field may be used to consolidate incidents which are strongly related to each other. 

* Example: <code>Occurrences: 6</code> 

##### TLP: [optional][only once]

This field may be used to indicate the sensitivity of the information in the report.
Please see the [Wikipedia](http://en.wikipedia.org/wiki/Traffic_Light_Protocol) article.   
 
* Example: <code>TLP: amber</code>   

*There are already some containers in use that have been designed by the community. If you have ideas for optional fields in existing containers or ideas for completely new containers, please join the X-ARF [mailinglist](http://lists.x-arf.org/cgi-bin/mailman/listinfo/).*
